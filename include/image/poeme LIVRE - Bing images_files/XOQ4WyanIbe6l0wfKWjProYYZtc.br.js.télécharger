var SvCtrlV2;(function(n){function t(n,t){try{var i=_d.elementsFromPoint(n,t)||[];return Array.prototype.slice.call(i)}catch(r){return[]}}function i(n,t){for(var r=n&&n.length||0,i=0;i<r;i++)t(n[i])}function f(n){try{return JSON.parse(n)}catch(t){return null}}function r(n,t){if(n)for(var i in n)t(i,n[i])}function e(n,t){var i=n;return r(t,function(n,t){i[n]=t}),i}function o(n){if(n&&n.target){var r=n.target.getBoundingClientRect(),u=r.x,f=r.right,e=r.y,o=r.bottom,s=t((u+f)/2,(e+o)/2);i(s,function(n){n.tagName==="A"&&n.hasAttribute("h")&&_w.si_T&&_w.si_T(n.getAttribute("h"))})}}function s(n,t){if(!(n&&t))return!1;try{return n.contains(t)}catch(i){return!1}}function u(n){if(!n)return null;try{return n.getBoundingClientRect()}catch(t){return null}}function h(n,i){var r;if(!(n&&i))return!1;try{if(r=u(n),!r)return;var f=r.x,e=r.y,o=t(f,e);return l(o,i)}catch(s){return!1}}function c(t){var i,r;if(!t||!n.localCollectionNames)return!1;i=t.toLowerCase();for(r in n.localCollectionNames)if(i==r.toLowerCase())return!0;return!1}function l(n,t){try{return n&&n.length&&n.indexOf(t)>-1}catch(i){return!1}}n.elementsFromPoint=t;n.iterateThroughList=i;n.parseJsonString=f;n.iterateOverObject=r;n.objectAssign=e;n.fireOverlapping=o;n.elementContains=s;n.getClientRect=u;n.isElementInSpaceOfAnother=h;n.isCollectionExists=c})(SvCtrlV2||(SvCtrlV2={})),function(n){function i(n){return n&&n.tagName==="A"}function t(n,t,i){n&&t&&i&&n.addEventListener(t,i)}function r(n,i){t(n,"keydown",function(n){n.keyCode==13&&i(n)})}function o(n,u,f,e){if(f===void 0&&(f=!0),e===void 0&&(e=!0),n&&u){var o=i(n)?u:function(n){e&&(sj_pd(n),n.stopImmediatePropagation());u(n)};t(n,"click",o);f&&r(n,o)}}function s(n,t){n&&t&&u(n,f,t)}function h(n,t){n&&t&&u(n,e,t)}function u(i,r,u){i&&u&&n.iterateThroughList(r,function(n){t(i,n,u)})}var f=["mouseenter","focusin"],e=["mouseleave","focusout"];n.isAnchorElement=i;n.addListenerToElement=t;n.addEnterKeyListener=r;n.addClickListener=o;n.addInListeners=s;n.addOutListeners=h}(SvCtrlV2||(SvCtrlV2={})),function(n){function r(n,i){if(n&&i){var r=n[t];return r&&r.contains(i)}}function i(n,i,r){n&&n[t]&&n[t][r](i)}function u(n,t){i(n,t,"add")}function f(n,t){i(n,t,"remove")}var t="classList";n.elementHasClass=r;n.addElementClass=u;n.removeElementClass=f}(SvCtrlV2||(SvCtrlV2={})),function(n){function t(n,t){return t===void 0&&(t=!0),function(i,r){if(!r)return"";var u=n?n[r]:"";return t&&u.length&&(u=encodeURIComponent(u)),u}}function i(i,r){if(i&&r)return n.urlParamsTemplate.replace(/\{(\d)\}/g,t([i,r]))}function r(t){if(n.itemSchema||(n.itemSchema={}),t&&t.length>0){var i=t.split(":"),r=i[0],u=i[1];n.itemSchema[r]=u}}function u(t){var i;if(!t)return null;if(i=t.dataset,i){var r=i.svptnk,u=i.svptnerinfo,f=i.svitminfp,e=i.svcptid,o=i.ufmc,s=i.sfmc,h=i.svstb,c=i.svmdcmp,l=i.svloc,a=i.svattr,v=i.persbtncls,y=n.parseJsonString(u)||{};return n.objectAssign(n.parseJsonString(f)||{},{PredefinedType:y,Key:r,ComponentId:e,UnsavedFormCode:o,SavedFormCode:s,SavedLinkSameTab:!!h,MetaLocInfo:{MetadataLocationId:l,MetadataLocationAttr:a,MetaLocCompName:c},PersButtonClassName:v})}}function f(){if(n.singlePartner){var f=n.singlePartner.Mapping,e=n.singlePartner.SavedFormCode,o=n.singlePartner.SavedLinkSameTab,t=n.singlePartner.PredefinedType,s=t.Title,h=t.CollectionTagPath,u=t.PredefinedCollectionType,c=t.ItemType,l=t.APIItemType,a=n.singlePartner.Key,v=n.singlePartner.SourceAttr,y=n.singlePartner.ItemTagPath,p=n.singlePartner.AttachToElementSelector,w=n.singlePartner.AttachDelay,b=n.singlePartner.ComponentId,k=n.singlePartner.PersButtonClassName;f&&n.iterateThroughList(f.split(","),r);c&&(n.defaultItemType=c);a&&(n.partnerKey=a);u&&(n.defaultCollectionType=u,n.defaultCollectionId=Constants.PredefinedCollections[u]);s&&(n.defOrCustCollName=s);h&&(n.collTagPath=h);y&&(n.itemTagPath=y);b&&(n.compName=b);v&&(n.sourceAttribute=v);l&&(n.apiItemType=l);p&&(n.attachElementSelector=p,w&&(n.attachDelay=w));e&&(n.savedFormCode=e);o&&(n.savedLinkSameTab=o);n.apiItemType&&n.compName&&(n.urlParams=i(n.apiItemType,n.compName));k&&(n.persistentButtonClassName=k)}}function e(t,i){var r=t&&t.getAttribute("data-svcptid"),e;r&&!n.componentMap[r]&&(e=u(t),n.componentMap[r]=e,n.partnerCount++,n.partnerCount===1&&(n.singlePartner=e,f()));i&&i(t)}n.componentMap={};n.partnerCount=0;n.urlParamsTemplate="type={0}&Comp={1}";n.registerPartnerAndComponent=e}(SvCtrlV2||(SvCtrlV2={})),function(n){function g(i){var r={ItmId:n.currentElementMid,CompName:n.currentCompName};t(s,v,r,MMInstUtils.getInstKData(i))}function nt(i){var u={ColCount:i,CompName:n.currentCompName};t(r,l,u)}function tt(){var i={CompName:n.currentCompName};t(r,a,i)}function it(r,u){var f={ColId:u,CollName:n.localCollectionsMap[u],CompName:n.currentCompName,ClkSrc:p};t(i,"",f,MMInstUtils.getInstKData(r))}function rt(r){var u={CompName:n.currentCompName,ClkSrc:w};t(i,"",u,MMInstUtils.getInstKData(r))}function ut(r,u){var f={ColId:u,ColName:n.localCollectionsMap[u],CompName:n.currentCompName,ClkSrc:y};t(i,"",f,MMInstUtils.getInstKData(r))}function ft(r){var u={CompName:n.currentCompName,Clksrc:b};t(i,"",u,MMInstUtils.getInstKData(r))}function et(r){var u={CompName:n.currentCompName,Clksrc:k};t(i,"",u,MMInstUtils.getInstKData(r))}function ot(i,r,f,o,s){var h={ColId:s,ItmId:r,CompName:n.currentCompName,ClkSrc:f,IsNewCol:o?"1":"0"};t(u,e,h,MMInstUtils.getInstKData(i))}function st(i){var r={ItmId:n.currentElementMid,CompName:n.currentCompName};t(f,e,r,MMInstUtils.getInstKData(i))}function ht(i,r,f,e){var s={ColId:r,ItmId:f,CompName:n.currentCompName,ClkSrc:e};t(u,o,s,MMInstUtils.getInstKData(i))}function ct(i){var r={ItmId:n.currentElementMid,CompName:n.currentCompName};t(f,o,r,MMInstUtils.getInstKData(i))}function lt(i,r){var u={CompName:n.currentCompName,ErrorType:r};t(h,d,u,MMInstUtils.getInstKData(i))}function t(n,t,i,r){t===void 0&&(t="");i===void 0&&(i=null);r===void 0&&(r=null);MMInstUtils.logEvent(n,c,t,i,r)}var r="CI.Saves",s="CI.Hover",i="CI.SaveClick",u="CI.Success",f="CI.Failure",h="CI.SaveErr",c="SaveControl",e="Saved",o="Unsaved",l="GetCollections",a="GetCollFailed",v="ShowFlyout",y="LnkClk",p="ColLst",w="CrtNewBtn",b="ColExp",k="SvCtrlBtn",d="UIState";n.logHoverFlyoutShown=g;n.logGetCollectionsSucceeded=nt;n.logGetCollectionsFailed=tt;n.logCollLstClick=it;n.logCreateButtonClick=rt;n.logLinkClick=ut;n.logCollExpandClick=ft;n.logSaveControlBtnClick=et;n.logAddItemSucceeded=ot;n.logAddItemFailed=st;n.logDeleteItemSucceeded=ht;n.logDeleteItemFailed=ct;n.logErrorState=lt}(SvCtrlV2||(SvCtrlV2={})),function(n){function l(n){gi=n}function a(){return gi}function wt(t){n.removeElementClass(n.currentHoveredElement,ot);n.currentElementMid=null;n.currentElementCollId&&(sj_evt.fire("onCurrentCollIdUnset",n.currentElementCollId),n.currentElementCollId=null);t?it(t):(n.currentHoveredElement=null,n.currentElementTurl=null,n.currentElementMetadata=null)}function s(t,i){var r,u;return(i===void 0&&(i=n.sourceAttribute),!t)?null:(r=t.hasAttribute(i)?t:hr(t,i),!r)?null:(u=r.getAttribute(i),!u)?null:n.parseJsonString(u)}function bt(t,i,r){t&&(n.addElementClass(t,r),n.removeElementClass(t,i))}function ur(n){n&&bt(n,k,et)}function ff(n){n&&bt(n,et,k)}function kt(t){t&&n.removeElementClass(t,k)}function ef(){if(n.currentElementTemp){var t=n.currentElementTemp;return n.currentElementTemp=null,t}}function fr(n){var r,t,i,u,f;if(n&&n.items){for(r=n.items,t=r.length-1;t>=0;t--)if(i=r[t],i&&i.content){if(u=i.content,!u)continue;if(f=ar(u),f)return f}return null}}function v(n){if(n){var t=n.mid,i=n.sid;return t||i}}function er(i,u,e,h){var y,l,a,b;if(u===void 0&&(u=n.currentHoveredElement),h===void 0&&(h=n.sourceAttribute),y=1,l=u||n.currentHoveredElement,l){var p=i in Constants.PredefinedCollections,k=p?Constants.PredefinedCollections[i]:null,g=n.localCollectionsMap[i],w=function(t,r,u){return(u===void 0&&(u=null),!(t&&t[c]))?!1:(i&&(n.latestCollId=i),sj_evt.fire("onCurrentCollIdSet",i),dt(),yr(u,l,t,r,e,g,i,!1))},d=n.currentUrlParams;if(l.hasAttribute(o)&&typeof t.addEdgeGenericItem!==r)t.addEdgeGenericItem(n.parseJsonString(l.getAttribute(o)),i,function(t){return w(t,!0,n.currentElementMid)},function(){return f(y)},n.currentCompName);else{if(a=s(l,h),!a){f(7);return}b=v(a);ii(a)&&typeof t.addGenericItem!==r?t.addGenericItem(d,a,n.itemSchema,n.itemTagPath,p?k:null,n.localCollectionsMap[i],i,n.partnerKey,null,function(n){return w(n,!0,b)},function(){return f(y)}):typeof t.addNonGenericItem!==r&&t.addNonGenericItem(d,a,n.defaultItemType,n.itemSchema,i,p?k:null,n.localCollectionsMap[i],function(n){return w(n,!1,b)},function(){return f(y)})}}}function or(i,u,e,h){var p=1,a=u||n.currentHoveredElement,y,w,l,k,b;if(a)if(y=function(t,r,u){var o,s,f;return(u===void 0&&(u=null),!(t&&t[c]))?!1:(f=(s=(o=t.targetCollectionOperationStatus)===null||o===void 0?void 0:o.collection)===null||s===void 0?void 0:s.id,f)?(rt(f,i),n.latestCollId=f,sj_evt.fire(d,!0,f,i,n.currentElementTurl,null,!0),e&&e(t),dt(),yr(u,a,t,r,"Flyt",i,f,!0)):!1},w=n.currentUrlParams,a.hasAttribute(o)&&typeof t.addEdgeGenericItemToNewColl!==r)t.addEdgeGenericItemToNewColl(n.parseJsonString(a.getAttribute(o)),i,function(n){return y(n,!0)},function(){return f(p)},n.currentCompName);else{if(l=s(a),k=function(){f(7);h()},!l){k();return}b=v(l);ii(l)&&typeof t.addGenericItem!==r?t.addGenericItem(w,l,n.itemSchema,n.itemTagPath,null,i,null,n.partnerKey,n.collTagPath,function(n){return y(n,!0,b)},function(){return f(p)}):i&&typeof t.addNonGenericItem!==r&&t.addNonGenericItem(w,l,n.defaultItemType,n.itemSchema,null,null,i,function(n){return y(n,!1,b)},function(){return f(p)})}}function sr(i,u,e){var y=2,h=e||n.currentHoveredElement,c,s,l,a,v;h&&(c=n.currentElementMid,s=n.localSavedItemsMap[c],s)&&(l=function(t){return n.latestCollId=i,sj_evt.fire("onCurrentCollIdUnset",i),dt(),vf(c,h,t,u,s.cid||null,i)},a=n.currentUrlParams,(h.hasAttribute(o)||n.currentElementMetadata&&ii(n.currentElementMetadata))&&typeof t.deleteGenericItem!==r?t.deleteGenericItem(a,s.cid,n.kctColls[i]||i,l,function(){return f(y)}):typeof t.deleteNonGenericItem!==r&&(v=i in Constants.PredefinedCollections,t.deleteNonGenericItem(a,v?Constants.PredefinedCollections[i]:"",v?"":i,s.cid,n.defaultItemType,l,function(){return f(y)})))}function sf(t,r,u,f){var e=f||n.currentHoveredElement,o;if(e){if(n.logSaveControlBtnClick(e),sj_evt.fire("onSaveInProgress",e),t==n.CustomCollDummyId){or(n.defOrCustCollName,n.currentHoveredElement,function(){n.removeCollectionFromPicker(n.CustomCollDummyId)});return}o=n.elementHasClass(e,i)||n.elementHasClass(n.hoverContainerSub,i);!o&&(n.localSavedItemsMap===null||n.localSavedItemsMap===void 0?void 0:n.localSavedItemsMap[n.currentElementMid])&&(o=!0);o?u&&sr(t,r):er(t,e,r)}}function dt(){u&&u.broadcastMessage(u.BCActionMessage)}function gt(t,i,r,u,f){n.standalone&&sj_evt.fire(au,t,i,r,u,f)}function hf(i){var u,f,e;if(nt)for(u in n.localSavedItemsMap)if(f=n.localSavedItemsMap[u],f.rawItem&&(e=f.rawItem,typeof t.checkGenericItem!==r&&t.checkGenericItem(i,e)))return u;return null}function it(t,r,u,f){var c,l,e,a,h;r===void 0&&(r=n.sourceAttribute);u===void 0&&(u=n.urlParams);f===void 0&&(f=n.compName);n.addElementClass(t,ot);n.currentHoveredElement=t;e=s(t,r)||s(t,o);e&&(n.currentElementMetadata=e,n.currentElementMid=v(e)||hf(e),n.currentElementTurl=e.turl,n.currentElementTurl||(a=(l=(c=e.ThumbnailInfo)===null||c===void 0?void 0:c[0])===null||l===void 0?void 0:l.Thumbnail,a&&(n.currentElementTurl=a)),h={},n.currentElementMid?((n.localSavedItemsMap===null||n.localSavedItemsMap===void 0?void 0:n.localSavedItemsMap[n.currentElementMid])?(n.currentElementCollId=n.localSavedItemsMap[n.currentElementMid].lastCollection,n.currentElementCollId&&sj_evt.fire("onCurrentCollIdSet",n.currentElementCollId),h=n.localSavedItemsMap[n.currentElementMid].collections,n.addElementClass(t,i),n.addElementClass(n.hoverContainerSub,i)):n.removeElementClass(n.hoverContainerSub,i),sj_evt.fire("onHoverElementSet",h)):(n.removeElementClass(n.hoverContainerSub,i),n.removeElementClass(t,i),sj_evt.fire("onHoverElementSet",h)));n.currentUrlParams=u;n.currentCompName=f}function ni(t){var i,r;return t?(i=n.defaultItemType in bi?bi[n.defaultItemType]:null,!i)?t:(r=n.defaultItemType+":"+i+"=",(t.indexOf(r)!==0?r:"")+t):null}function hr(n,t){return n?_qs("["+t+"]",n):null}function y(t){var i=hr(n.containerElement,n.sourceAttribute+'*="'+t+'"');if(!i)return null;while(!e(i)&&i[vi])i=i[vi];return e(i)?i:null}function e(t){return t&&n.elementHasClass(t,ei)}function p(t,r,u,f,e,o){if(t&&r){if(!(r in n.localSavedItemsMap)){n.elementHasClass(t,i)&&n.removeElementClass(t,i);return}n.addElementClass(t,i);u&&(t&&sj_evt.fire("Saved",t),n.logAddItemSucceeded(t,r,f,e,o))}}function ti(t,r,u,f,e){t&&r&&(r in n.localSavedItemsMap||n.removeElementClass(t,i),u&&(t&&sj_evt.fire("Unsaved",t),n.logDeleteItemSucceeded(t,e||at,r,f)))}function cr(t,i,r,u,f){var e,o;t&&(t in n.localSavedItemsMap?(u&&n.localSavedItemsMap[t].lastCollection||(n.localSavedItemsMap[t].lastCollection=r),n.localSavedItemsMap[t].collections[r]||(n.localSavedItemsMap[t].collections[r]=!0,n.localSavedItemsMap[t].numCollections++),u?n.localSavedItemsMap[t].collectionQueue.unshift(r):n.localSavedItemsMap[t].collectionQueue.push(r)):(o={cid:f?i:ni(i),rawItem:f?f:null,collections:(e={},e[r]=!0,e),lastCollection:r,collectionQueue:[r],numCollections:1},n.localSavedItemsMap[t]=o))}function lr(t,i){if(t&&n.localSavedItemsMap[t])if(at=i,n.localSavedItemsMap[t].numCollections===1)delete n.localSavedItemsMap[t],n.currentElementMid===t&&(n.currentElementCollId=null);else{delete n.localSavedItemsMap[t].collections[i];n.localSavedItemsMap[t].numCollections--;var r=n.localSavedItemsMap[t].collectionQueue.indexOf(i);r>-1&&(n.localSavedItemsMap[t].collectionQueue.splice(r,1),n.localSavedItemsMap[t].lastCollection=n.localSavedItemsMap[t].collectionQueue.slice(-1)[0],n.currentElementMid===t&&(n.currentElementCollId=n.localSavedItemsMap[t].lastCollection))}}function cf(n,t){n&&(ur(n),sj_evt.fire("onSaveControlError",t))}function ar(n){var t,i;return n.thumbnailUrl||((i=(t=n.thumbnails)===null||t===void 0?void 0:t[0])===null||i===void 0?void 0:i.thumbnailUrl)}function vr(t,i,r,u){n.localCollectionsCidMap[t]||(n.localCollectionsCidMap[t]=[]);n.localCollectionsCidMap[t].indexOf(i)<=-1&&(u?n.localCollectionsCidMap[t].push(i):n.localCollectionsCidMap[t].unshift(i));n.cidToThumbnailUrlMap[i]||(n.cidToThumbnailUrlMap[i]=r)}function lf(t,i){var r,u;if(n.localCollectionsCidMap[t])return(u=n.localCollectionsCidMap[t].indexOf(i),u<=-1)?void 0:(n.localCollectionsCidMap[t].splice(u,1),((r=n.localCollectionsCidMap[t])===null||r===void 0?void 0:r[0])||null)}function af(t,i){var r,u;return t?(r=n.parseJsonString(t.getAttribute(o)),r||(r=s(t,n.sourceAttribute)),!r)?null:(u={url:r.ClickThroughUrl,customData:r.CustomData,domain:r.FriendlyDomainName,itemTagPath:r.ItemTagPath,title:r.Title,_type:"GenericItem"},{collectionItemId:i,content:u,itemtype:"Generic"}):null}function yr(t,i,r,u,f,o,s,h){var w=r.targetCollectionOperationStatus,b,l,k,d,it,rt;if(!(w&&w[c]))return!1;try{var g=w,nt=g.itemOperationStatuses,ut=li,v=g[ut];if(!(nt&&v&&v.id))return!1;var ft=nt,tt=ft[0],et=c,ot=tt[et],ht=ai,a=tt.item[ht];return ot?(b=s in Constants.PredefinedCollections,l=b?s:v.id,n.latestCollId=l,b&&(n.kctColls[s]=v.id),t||n.currentElementMid!==null||a===null||(k=a.substring(a.indexOf(":")+1),t=k,n.currentElementMid=k),!t&&n.currentElementMid&&(t=n.currentElementMid),d=u?a:ni(a),vr(l,d,n.currentElementTurl,!1),n.localCollectionsMap[l]&&sj_evt.fire("onChangeCollThumbnail",l,n.currentElementTurl),it=t?n.localSavedItemsMap[t]:!1,rt=u?af(i,a):null,cr(t,d,l,!1,rt),n.localSavedItemsMap[t]&&gt(1,0,h?1:0,n.localSavedItemsMap[t].numCollections),i)?(p(i,t,!0,f,h,l),sj_evt.fire(st,l,n.localCollectionsMap[l],t&&n.localSavedItemsMap[t].numCollections||1),e(i)||p(y(t),t,!1),pr("onSaveAdd",r,t,i,!it)):!1:!1}catch(ct){return!1}}function vf(t,i,r,u,f,o){var h,s;return(r&&r[c])?(lr(t,o),gt(0,1,0,n.localSavedItemsMap[t]?n.localSavedItemsMap[t].numCollections:0),i)?(ti(i,t,!0,u,o),h=lf(o,f),sj_evt.fire("onChangeCollThumbnail",o,h?n.cidToThumbnailUrlMap[h]:null),s=!n.localSavedItemsMap[t],s&&!e(i)&&ti(y(t),t,!1),sj_evt.fire(st,o,n.localCollectionsMap[o],s?0:n.localSavedItemsMap[t].numCollections),pr("onSaveDel",r,t,i,s)):!1:!1}function pr(t,r,u,f,e){if(f){if(kt(f),n.currentHoveredElement===f){n.removeElementClass(n.ctrl,oi);switch(t){case"onSaveAdd":n.addElementClass(n.hoverContainerSub,i);break;case"onSaveDel":e&&n.removeElementClass(n.hoverContainerSub,i)}kt(n.hoverContainerSub)}sj_evt.fire(t,r,u,f,e,typeof n.metaLocElement!="undefined"&&n.metaLocElement===f)}return at=null,!0}function ii(t,i){return i===void 0&&(i=n.defaultItemType),!("mid"in t)&&i!=="recipe"}function f(t){n.currentHoveredElement&&(cf(n.currentHoveredElement,t),t==1?n.logAddItemFailed(n.currentHoveredElement):t==2&&n.logDeleteItemFailed(n.currentHoveredElement))}function yf(){n.logGetCollectionsFailed();n.addElementClass(n.ctrl,oi);sj_evt.fire("onSaveControlError",3);vt=!1}function pf(t){n.logGetCollectionsSucceeded(t)}function wf(n){if(!(n&&n.content&&n.itemType))return null;var t=n.content,i=n.itemType;switch(i){case"Image":return t.imageId;case"Video":return t.videoId;case"Generic":return t.contentId;default:return null}}function bf(t){if(!t)return null;var u=t&&t[ai],i=u?decodeURIComponent(u):"",r=wf(t);return r||(r=/^[a-z]+:[a-z]+=/.test(i)?i.substring(i.indexOf("=")+1):i.replace("/"+n.partnerKey+"/:","")),{contentId:r,collectionItemId:i}}function rt(t,i){n.localCollectionsMap[t]=i;n.localCollectionNames[i]=1}function kf(t){if(!(t.length<=0)){var r=t.sort(function(n,t){return n.dateModified>t.dateModified?-1:1}),i=r[0];n.latestCollId=!i.knownCollectionType?i.id:Constants.PredefinedCollections[i.knownCollectionType]}}function df(t){var i,e;if(t){var u=t.collectionPage,f=t.id,r=t.knownCollectionType;(r&&(n.kctColls[Constants.PredefinedCollections[r]]=f),i=!r?f:Constants.PredefinedCollections[r],n.localCollectionsMap[i]||le(t),u&&u.items)&&(e=u.items,n.iterateThroughList(e,function(t){var f;if(t){var e=bf(t),u=e.collectionItemId,r=e.contentId;r&&u&&(t.content&&vr(i,u,ar(t.content),!0),cr(r,u,i,!0,t),f=y(r),f)&&(p(f,r),sj_evt.fire(st,i,n.localCollectionsMap[i],n.localSavedItemsMap[r].numCollections))}}))}}function gf(t){var i,r;return(t&&t.collections)?(i=t.collections,i=i.reverse(),r=(i===null||i===void 0?void 0:i.length)||0,pf(r),n.iterateThroughList(i,df),kf(i),sj_evt.fire("onSaveGet",t),nt||(nt=!0,tt&&(it(tt),tt=null)),n.defaultCollectionType&&!n.localCollectionsMap[n.defaultCollectionId]&&(rt(n.defaultCollectionId,n.defOrCustCollName),n.latestCollId||(n.latestCollId=n.defaultCollectionId),sj_evt.fire(d,!1,n.defaultCollectionId,n.defOrCustCollName,null,n.defaultCollectionType)),!n.defaultCollectionType&&n.collTagPath&&n.defOrCustCollName&&!n.isCollectionExists(n.defOrCustCollName)&&(n.latestCollId=n.CustomCollDummyId,sj_evt.fire(d,!1,n.CustomCollDummyId,n.defOrCustCollName)),n.singlePartner&&sj_evt.fire(g,n.singlePartner),sj_evt.fire("onCollectionsGotten"),!0):!1}function ne(t,i){n.hoverContainer&&n.hoverContainer.style.setProperty(t,i)}function wr(t){n.hoverContainerSub&&n.removeElementClass(n.hoverContainerSub,t)}function ri(t){n.hoverContainer&&t&&n.iterateOverObject(t,ne)}function br(t){n.hoverContainer&&ri({display:t})}function te(n){rr=new Date;yt===!1&&(yt=!0,setTimeout(function(){return kr(n)},pt))}function kr(t){var u=new Date,i,r;u.getTime()-rr.getTime()<pt?setTimeout(function(){return kr(t)},pt):(yt=!1,i=_qs("."+n.persistentButtonClassName,_d.body),(t===null||t===void 0?void 0:t.type)==="resize"&&i&&n.elementHasClass(n.hoverContainerSub,"b_scpers")?(r=n.getClientRect(i),ri({top:r.top+h,left:r.left+h})):w())}function w(t){var r=t||n.currentHoveredElement,i;if(n.hoverContainer&&r){if(l(!0),ae(),i=n.getClientRect(r),!i){l(!1);return}var u=i.top,f=i.bottom,e=i.left,o=i.width,s=i.height,c=f>_w.innerHeight?_w.innerHeight-u:s;ri({width:o+h,height:c+h,top:u+ir+h,left:e+tr+h});l(!1)}}function dr(){n.hoverContainer&&br("block")}function ut(){n.hoverContainer&&(br("none"),sj_evt.fire("onHoverContainerHide"))}function ie(t){var i=n.currentHoveredElement;i&&n.hoverContainerSub&&(n.elementHasClass(i,t)?n.addElementClass(n.hoverContainerSub,t):wr(t))}function re(){if(!a()){var t=gr(null);t&&(wt(t),n.hoverContainer&&(w(),dr(),n.removeElementClass(n.hoverContainerSub,"b_scpers"),n.iterateThroughList(ki,ie)),sj_evt.fire("onControlAppended"))}}function ue(t){if(!a()){var i=t[yi];if(i||ut(),i&&n.hoverContainer){if(n.elementContains(n.ctrl,i))return;n.isElementInSpaceOfAnother(i,n.hoverContainer)||ut()}}}function gr(n){ht&&sb_ct(ht);var t=nr;return nr=n,n&&(ht=sb_st(re,uf*2)),t}function fe(t){if(!a()){var i=t[pi];n.currentFocusTarget=t.target;i&&e(i)?gr(i):sj_pd(t)}}function ee(t){var i,r,u;if(!a()){if(i=t[pi],r=t[yi],!r){if(u=t[lu],t.type!=="mouseleave"&&n.elementContains(i,u))return;ut();return}if(!n.elementContains(n.ctrl,r)&&e(i)&&!n.elementContains(i,r)){if(t.type==="focusout"&&!n.elementContains(i,r)&&!n.shiftKeyDown){n.nextFocusable=r;n.ctrlBtn.focus();sj_evt.fire("onSaveButtonFocus");return}n.hoverContainer&&ut();n.iterateThroughList(ki,wr);n.iterateThroughList([hi,si,ci,ot],function(t){n.removeElementClass(i,t)});n.currentHoveredElement===i&&(wt(),n.currentFocusTarget==null)}}}function nu(t){t&&(n.addInListeners(t,fe),n.addOutListeners(t,ee),e(t)&&iu(t))}function ft(n,t,i){return(i===void 0&&(i=""),n&&n.children&&t)?n.querySelectorAll("."+t+i):[]}function tu(n){return n?ft(n,ei):[]}function ui(t){if(t){if(n.ctrl===null||n.ctrl===void 0?void 0:n.ctrl.dataset.bclist){var i=n.ctrl.dataset.bclist.toLowerCase().split(",");if((i===null||i===void 0?void 0:i.indexOf(n.compName===null||n.compName===void 0?void 0:n.compName.toLowerCase()))>-1)return}e(t)?nu(t):n.iterateThroughList(tu(t),nu)}}function iu(n){if(n){var t=s(n);t&&p(n,v(t))}}function oe(t){var i=t;i&&(i.type==="attributes"&&i.target&&n.iterateThroughList(tu(i.target),function(n){ui(n);iu(n)}),n.ctrl&&i.addedNodes&&i.addedNodes.length>0&&n.iterateThroughList(i.addedNodes,ui))}function se(i){n.partnerCount!==1||vt||(n.containerElement=i,typeof t.getCollections!==r&&(t.getCollections(n.urlParams,gf,yf),vt=!0));lt.observe(i,di);n.ctrl&&ui(i)}function he(t){for(var i=t,u={scroll:1,overlay:1,auto:1},r;i&&i.parentElement&&i!==(_d===null||_d===void 0?void 0:_d.body);){if(i.hasAttribute(wi))break;r=_w===null||_w===void 0?void 0:_w.getComputedStyle(i);(r.overflow in u||r.overflowX in u||r.overflowY in u)&&(n.addListenerToElement(i,"scroll",function(){w()}),i.setAttribute(wi,"1"));i=i.parentElement}}function ru(t){n.registerPartnerAndComponent(t,se);he(t)}function uu(t){var r,i,u,f;if(t&&(n.elementHasClass(t,b)?t.dataset.svcptid&&ru(t):n.elementHasClass(t,n.persistentButtonClassName)&&n.singlePartner&&sj_evt.fire(g,n.singlePartner),r=t.children,r))for(i=0,u=r;i<u.length;i++)f=u[i],uu(f)}function ce(t){var i=t;i&&(i.addedNodes&&i.addedNodes.length>0&&n.iterateThroughList(i.addedNodes,uu),i.removedNodes&&i.removedNodes.length>0&&n.iterateThroughList(i.removedNodes,function(t){n.elementHasClass(t,n.persistentButtonClassName)&&sj_evt.fire("onDeregisterPersBtn")}),i.attributeName&&i.target&&n.elementHasClass(i.target,n.persistentButtonClassName)&&n.singlePartner&&sj_evt.fire(g,n.singlePartner))}function fi(t){t&&n.iterateThroughList(t,ru)}function fu(t){return new MutationObserver(function(i){return n.iterateThroughList(i,t)})}function eu(n){var t=n[1],i=n[2],u,r;t&&i&&(u=i&&ni(i),u)&&(r=y(t),r&&p(r,t,!1))}function ou(n){var t=n[1],r=n[2],i;t&&(i=y(t),lr(t,r),i&&ti(i,t,!1))}function le(t,i){var f,r;i===void 0&&(i=!1);var h=t.id,e=t.title,o=t.collectionPage,s=t.knownCollectionType,u=s?Constants.PredefinedCollections[s]:h;!n.localCollectionsMap[u]&&e&&(rt(u,e),r=null,o&&((f=o.items)===null||f===void 0?void 0:f.length)&&(r=fr(o),r&&sj_evt.fire("onChangeCollThumbnail",u,r)),sj_evt.fire(d,i,u,e,r,s||null))}function ae(){tr=_w.scrollX||_w.pageXOffset;ir=_w.scrollY||_w.pageYOffset}function su(){(n.flyoutContainer===null||n.flyoutContainer===void 0?void 0:n.flyoutContainer.dataset.ebc)&&typeof CollChannel.CollectionsBroadcastChannel!="undefined"&&(u=new CollChannel.CollectionsBroadcastChannel(ye,null,null,!1),u===null||u===void 0?void 0:u.initialize())}function hu(){sj_evt.unbind("onFavAdd",eu);sj_evt.unbind("onFavDel",ou);sj_evt.unbind("ajax.unload",hu);sj_evt.unbind("onPersButtonInteract",cu);sj_evt.unbind("CollectionsBCLoaded",su);_d.body.removeChild(n.hoverContainer);ct.disconnect();lt.disconnect();u===null||u===void 0?void 0:u.close()}function cu(t){var i=t[1],r=t[2],u=t[3],f=t[4],e=t[5];it(r,u,f,e);w(i);dr();n.addElementClass(n.hoverContainerSub,"b_scpers");sj_evt.fire("onControlAppended")}function ve(){var n=_d.querySelector(":root"),t,i;n&&(n.style.setProperty(wu,tf),n.style.setProperty(bu,rf),t=getComputedStyle(n).getPropertyValue(gu),n.style.setProperty(ku,t),i=getComputedStyle(n).getPropertyValue(nf),n.style.setProperty(du,i))}function ye(){return}function pe(){n.ctrl=_ge("svctrl");n.ctrl&&(l(!1),n.addListenerToElement(n.ctrl,"mousedown",sj_sp));n.ctrlBtn=_ge("svctrlbtn");n.hoverContainer=_ge("svhvr");n.hoverContainerSub=_ge("svhvrsub");n.hoverContainer&&(_d.body.insertBefore(n.hoverContainer,_d.body.firstChild),n.addOutListeners(n.hoverContainer,ue));n.localSavedItemsMap={};n.localCollectionsMap={};n.localCollectionsCidMap={};n.cidToThumbnailUrlMap={};n.localCollectionNames={};n.latestCollId=null;n.currentElementCollId=null;n.currentElementMid=null;n.partners=[];lt=fu(oe);ct=fu(ce);ct.observe(_d.body,di);n.flyoutContainer=_ge("svflytc");n.flyoutContainer&&n.flyoutContainer.hasAttribute("data-svlne")&&(n.standalone=!!n.flyoutContainer.getAttribute("data-svlne"));n.standalone||fi(ft(_d.body,b));n.iterateOverObject(pu,sj_evt.bind);n.addListenerToElement(_w,vu,w);n.addListenerToElement(_w,yu,te);sj_evt.bind("onPersButtonInteract",cu);sj_evt.bind("ajax.unload",hu);sj_evt.bind("onCurrentElementSet",function(n){var t=n[1];fi(ft(_d.body,b));nt?it(t):tt=t},!0);_w.addEventListener("keydown",function(t){!n.shiftKeyDown&&t.shiftKey&&(n.shiftKeyDown=!0)});_w.addEventListener("keyup",function(t){!t.shiftKey&&n.shiftKeyDown&&(n.shiftKeyDown=!1)});sj_evt.bind("updateSaveState",function(){fi(ft(_d.body,b));n.singlePartner&&sj_evt.fire(g,n.singlePartner)},!0);sj_evt.bind("CollectionsBCLoaded",su,!0);(n.ctrl===null||n.ctrl===void 0?void 0:n.ctrl.dataset.isprom)&&ve()}var t=MySavesAPIUtils;n.containerElement=null;n.shiftKeyDown=!1;n.kctColls={};n.CustomCollDummyId="CustomCollId";var ei="isv",i="saved",b="isvctrl",et="err",k="ing",oi="b_geterr",si="isvfoc",hi="b_isvhvr",ci="b_schvr",ot="b_isvcur",li="collection",ai=li+"ItemId",c="isSuccess",vi="parentElement",r="undefined",yi="relatedTarget",pi="currentTarget",lu="target",h="px",o="data-saves-generic-item",wi="data-scrbind",d="onCollRegister",g="onPartnerRegister",st="onUpdateHoverBox",au="onSCEngagement",bi={webdoc:"url",recipe:"sid",video:"mid",image:"cid",product:"cid"},ki=[i,si,hi,k,et,ci],vu="scroll",yu="resize",pu={onFavAdd:eu,onFavDel:ou},di={childList:!0,subtree:!0,attributes:!0},wu="--icn-bg-color",bu="--svlbl-txt-color",ku="--svicn-bg-img",du="--unsvicn-bg-img",gu="--svicn-bg-img-prominent",nf="--unsvicn-bg-img-prominent",tf="#5087EC",rf="#FFFFFF",gi,nt=!1,tt=null,ht,ct,lt,at,nr,uf=0,tr=0,ir=0,u,vt=!1,rr,yt=!1,pt=500;n.setKeepFlyoutActive=l;n.getKeepFlyoutActive=a;n.clearCurrentHoveredElement=wt;n.metadataFromElement=s;n.switchElementClass=bt;n.switchElementToErrorClass=ur;n.switchElementToInProgressClass=ff;n.removeInProgress=kt;n.clearTempCurrentElement=ef;n.getThumbnailUrlFromCollectionPage=fr;n.getMetadataId=v;n.addToCollection=er;n.addToNewCollection=or;n.removeFromCollection=sr;n.handleSaveClick=sf;n.fireSCEngagementEvent=gt;n.addCollectionName=rt;pe()}(SvCtrlV2||(SvCtrlV2={})),function(n){function li(t){if(i){t||(t=n.currentElementMid);var r=t&&n.localSavedItemsMap[t],u=r?r.lastCollection:n.latestCollId,f=u&&n.localCollectionsMap[u]||n.defOrCustCollName;ri(u,f,r?r.numCollections:0)}}function ti(t,i){if(t&&pt!==t){n.removeElementClass(pt,"b_sclbl");n.addElementClass(t,"b_sclbl");pt=t;n.removeElementClass(ei,ft);var r=t.querySelector(i?"onsvd":"onusvd");n.addElementClass(r,ft);ei=r}}function rr(t){sj_sp(t);var i=t.target.value.trim(),r=n.isCollectionExists(i);d.setAttribute("aria-disabled",i&&!r?"false":"true");r?n.addElementClass(l,w):n.elementHasClass(l,w)&&n.removeElementClass(l,w)}function ai(t){var i,r=t[1];ri(r,n.localCollectionsMap[r],n.currentElementMid&&((i=n.localSavedItemsMap[n.currentElementMid])===null||i===void 0?void 0:i.numCollections))}function ur(t){var i=t[1];i==5?(n.removeElementClass(at,dt),n.addElementClass(at,kt)):tt&&(f.textContent=tt[i],n.removeElementClass(f,dt),n.addElementClass(f,kt));n.logErrorState(n.currentHoveredElement,n.UiErrorStates[i]);n.fireSCEngagementEvent(0,0,0,n.currentElementMid&&n.localSavedItemsMap[n.currentElementMid]?n.localSavedItemsMap[n.currentElementMid].numCollections:0,n.UiErrorStates[i]);b(c)}function fr(t){var f=t[0],r=t[1],u=t[2],i=t[3];i===0?n.removeElementClass(n.hoverContainerSub,ot):n.addElementClass(n.hoverContainerSub,ot);ri(r,u,i)}function er(){var e;if(n.ctrl&&(e=n.ctrl.dataset,e)){var s=e.dly,p=e.sfmc,v=e.svctrlv3;s&&(wt=parseInt(s,10));n.savedFormCode||(n.savedFormCode=p);v&&(it=v)}h=_ge("svctrlinlineform");ct=_ge("svctrlnewint");d=_ge("svctrlinlineformcreate");a=_ge("svctrlhvr");t||(t=_ge("svflytc"));i=_ge("svctrllnk");vt=_ge("sccolltxt");fi=i.getAttribute("href");yt=_ge("svctrlhvrnum");c=_ge("svctrlerr");f=_ge("svctrlerrtxt");r=_ge("svctrlhvrbtn");lt=_ge("svctrllstw");g=_ge("svctrlhvrpnl");at=_ge("svctrlmsmtcherrtxt");nt=_ge("svctrlmsmtchlnk");y=_ge("svctrlhvrpnlbtn");l=_ge("svctrlinlineformerrdup");h&&(u=_ge("svctrlinlineformname"),n.addClickListener(_ge("svctrlinlineformback"),ii),n.addClickListener(d,wi),u&&(n.addEnterKeyListener(u,wi),n.addListenerToElement(u,"keyup",rr)));i&&n.isAnchorElement(i)&&n.addClickListener(i,nr);nt&&n.isAnchorElement(nt)&&n.addClickListener(nt,nr);t&&(n.standalone||n.addOutListeners(t,pr),it||(n.addInListeners(n.ctrlBtn,br),n.addOutListeners(n.ctrlBtn,kr)),a&&n.addClickListener(r,vr),n.addClickListener(_ge("svctrltri"),dr,!1),t.hasAttribute(ci)&&(tt=n.parseJsonString(t.getAttribute(ci))));sj_evt.bind("onControlAppended",gr);sj_evt.bind("onSaveInProgress",lr);sj_evt.bind("onSaveAdd",hr);sj_evt.bind("onSaveDel",cr);sj_evt.bind("onHoverContainerHide",st);sj_evt.bind("onCurrentCollIdSet",ai);sj_evt.bind("onUpdateHoverBox",fr);sj_evt.bind("onSaveButtonClick",o);n.standalone||sj_evt.bind("onCollListExpand",ki);sj_evt.bind("onSaveControlError",ur);n.standalone&&(sj_evt.bind(si,sr),sj_evt.bind(hi,or));sj_evt.bind("onSaveButtonFocus",ar)}function or(n){var t=n[0],i=n[1];t==hi&&ir(null,null,i)}function sr(t){var i=t[0];i==si&&s!=c&&(ai([null,n.currentElementCollId||n.latestCollId]),b(a),di())}function vi(t){var i;li(t);(!it||n.isCreateDialogShowing)&&o();pi((i=n.localSavedItemsMap[t])===null||i===void 0?void 0:i.numCollections)}function hr(t){var i=t[3];n.currentHoveredElement===i&&(vi(n.currentElementMid),n.addElementClass(n.hoverContainerSub,ot))}function cr(t){var i=t[3],r=t[4];n.currentHoveredElement===i&&(vi(n.currentElementMid),r&&n.removeElementClass(n.hoverContainerSub,ot))}function yi(){n.removeElementClass(c.querySelector("."+ft),ft)}function lr(t){var i=t[1],r=t[2];n.standalone||(yi(),n.currentHoveredElement===i&&ti(_ge("svctrlhvrpnling"),r))}function ar(){t&&o()}function ii(){r&&h&&(n.removeElementClass(g,v),n.removeElementClass(lt,v),n.removeElementClass(h,e),n.removeElementClass(r,v),n.addElementClass(r,e),n.setKeepFlyoutActive(!1),u.value="",u.disabled=!0,r.setAttribute("tabindex","0"),i.setAttribute("tabindex","0"),y&&y.setAttribute("tabindex","0"),n.collectionList&&n.collectionList.setAttribute("tabindex","0"),n.isCreateDialogShowing=!1)}function vr(){(n.clearTempCurrentElement(),r&&h)&&(n.addElementClass(g,v),n.addElementClass(lt,v),n.addElementClass(r,v),n.addElementClass(h,e),n.removeElementClass(r,e),n.setKeepFlyoutActive(!0),u.value="",u.disabled=!1,u.focus(),n.removeElementClass(l,w),d.setAttribute("aria-disabled","true"),r.setAttribute("tabindex","-1"),i.setAttribute("tabindex","-1"),y&&y.setAttribute("tabindex","-1"),n.collectionList&&n.collectionList.setAttribute("tabindex","-1"),n.isCreateDialogShowing=!0)}function pi(n){if(yt&&n!==undefined&&n!==null){var t=n-1;yt.textContent=t>0?"+"+t:""}}function ri(r,u,f){var o,s=n.standalone&&((o=t===null||t===void 0?void 0:t.dataset)===null||o===void 0?void 0:o.htc)&&(!f||f==0),e;(s?(i.textContent=t.dataset.htc,ht=""):(i.textContent=u,ht=r,it&&vt&&(vt.textContent=u)),n.isAnchorElement(i))&&(e=fi,n.savedFormCode&&(e+="&FORM="+n.savedFormCode),s||(e+="&collId="+r),i.setAttribute("href",e),n.savedLinkSameTab&&i.hasAttribute(et)?i.removeAttribute(et):i.setAttribute(et,"_blank"),pi(f))}function wi(){var i,t;if(n.logCreateButtonClick(n.currentHoveredElement),t=(i=u.value)===null||i===void 0?void 0:i.trim(),t){if(n.isCollectionExists(t)){n.addElementClass(l,w);return}n.currentElementTemp=n.currentHoveredElement;b(ct);n.addToNewCollection(t,n.currentElementTemp,null,ii)}}function yr(t){n.nextFocusable.focus();n.nextFocusable=null;sj_pd(t)}function pr(i){if(!n.getKeepFlyoutActive()){var r=i.relatedTarget;if(i.type==="focusout"&&!n.elementContains(t,r)&&n.nextFocusable){yr(i);return}if(r){if(n.isElementInSpaceOfAnother(t,r))return;if(n.elementContains(n.ctrl,r))return;if(n.isElementInSpaceOfAnother(n.ctrl,r))return}st();n.clearCurrentHoveredElement()}}function bi(){p&&(sb_ct(p),p=null)}function ki(){var i,r,a,s,h,c,v,f;if(t&&(n.removeElementClass(n.ctrl,bt),t.style.removeProperty("left"),t.style.removeProperty("right"),t.style.removeProperty("bottom"),n.removeElementClass(n.ctrl,rt),n.removeElementClass(n.ctrl,oi),i=n.getClientRect(t),i)){var u=Math.min(n.getClientRect(_d.body).width,_w.innerWidth),l=i.width,e=i.right,o=i.left;if(o<0?e+l>u?(n.addElementClass(n.ctrl,bt),r=(e-u)/2,o+r<=0&&(r-=ni),t.style.right=r+"px"):n.addElementClass(n.ctrl,rt):e>u&&(o<l?(n.addElementClass(n.ctrl,bt),r=o/2,e-r>=u&&(r+=ni),t.style.left=-1*r+"px"):n.elementHasClass(n.hoverContainerSub,"b_scpers")?i&&i.right>u?(a=u-i.right,t.style.left=a-ni+"px"):n.addElementClass(n.ctrl,rt):n.addElementClass(n.ctrl,rt)),s=n.ctrl===null||n.ctrl===void 0?void 0:n.ctrl.dataset.flyoutpos,h=s?3:1,i=n.getClientRect(t),c=Math.min(n.getClientRect(_d.body).height,_w.innerHeight)-i.bottom,v=g.clientHeight+Math.min(3.5,Object.keys(n.localCollectionsMap).length)*48,c<t.clientHeight/h||c<v/h)if(n.addElementClass(n.ctrl,oi),s){var w=n.getClientRect(n.ctrlBtn),b=n.getClientRect(n.currentHoveredElement),k=_qs(".svbtnlbl",n.ctrlBtn);i=n.getClientRect(t);k&&(f=n.getClientRect(k),w.left-b.left<b.right-w.right?i.left-f.right<0&&f.right-i.right<0&&(t.style.bottom=n.ctrlBtn.clientHeight+"px"):i.left-f.left<0&&f.left-i.right<0&&(t.style.bottom=n.ctrlBtn.clientHeight+"px"))}else{var y=n.ctrlBtn.clientLeft,d=n.ctrlBtn.clientWidth,p=t.clientLeft,nt=t.clientWidth;y>=p&&y+d<=p+nt&&(t.style.bottom=n.ctrlBtn.clientHeight+"px")}}}function wr(){b(a);ti(_ge("svctrlhvrpnltxt"),!0)}function di(){t&&(n.addElementClass(n.ctrl,ut),yi(),n.standalone||ki(),ui&&n.standalone||(n.logHoverFlyoutShown(n.currentHoveredElement),ui=!0),sj_evt.fire("onResetScroll"),k=!0,bi())}function st(){t&&(n.removeElementClass(n.ctrl,ut),b(),bi(),k=!1)}function o(){wr();k||di()}function gi(){o();sj_evt.fire("prismFocusChange",n.currentHoveredElement)}function br(i){i.relatedTarget&&(n.getKeepFlyoutActive()||(sj_pd(i),sj_sp(i),n.addElementClass(n.ctrl,ut),n.hoverContainerSub&&n.addElementClass(n.hoverContainerSub,"b_schvr"),sj_evt.fire("onSaveHover"),t&&(wt&&!p?p=sb_st(gi,wt):gi())))}function kr(t){if(t.type==="focusout"){if(n.shiftKeyDown){n.currentFocusTarget&&n.currentFocusTarget.focus();t.stopImmediatePropagation();sj_sp(t);sj_pd(t);return}o();s.focus();return}if(!n.getKeepFlyoutActive()){var i=t.relatedTarget;if(i){if(n.elementContains(n.ctrl,i))return;if(n.isElementInSpaceOfAnother(n.hoverContainer,i))return}n.clearCurrentHoveredElement();t.type==="mouseleave"&&(n.removeElementClass(n.ctrl,ut),st())}}function dr(t){var i=n.elementsFromPoint(t.clientX,t.clientY);i&&i.length>1&&i[1].click()}function nr(t){var i=t[et];si_ct(i,!1,t);n.logLinkClick(n.currentHoveredElement,ht);n.standalone&&(sj_evt.fire("onNewTabOpenRequest",i.getAttribute("href")),t.preventDefault());sj_sp(t)}function b(t){var o,i,u,h;if(s&&(n.removeElementClass(s,e),o=t==ct,n.setKeepFlyoutActive(o),n.getKeepFlyoutActive()?n.addElementClass(n.ctrl,"b_scnapd"):n.removeElementClass(n.ctrl,"b_scnapd")),!t){s=null;sj_evt.fire(gt,1);return}n.elementHasClass(n.ctrl,"b_geterr")&&(f.textContent=tt[3],n.removeElementClass(f,dt),n.addElementClass(f,kt),t=c);n.addElementClass(t,e);t==a&&(n.addElementClass(r,e),ii());s=t;i=null;switch(t){case a:u=_ge("svctrlpckr");u?(h=u.getAttribute("aria-expanded")==="false",i=h?3:4):i=3;break;case c:i=5}sj_evt.fire(gt,i)}function gr(){i&&(li(),sj_evt.fire(gt,2))}function tr(t,i,r){var u=n.localSavedItemsMap[t||n.currentElementMid];u&&u.numCollections>1?sj_evt.fire("onBtnToggleCollList"):n.handleSaveClick(n.currentElementCollId||n.latestCollId,"Btn",r,i)}function ir(n,t,i){o();tr(n,t,i)}function nu(){k?st():o()}function tu(n,t,i){tr(n,t,i);ti(_ge("svctrlhvrpnltxt"),!0)}var ui=!1,ht,k=!1,s,r,h,u,d,ct,c,f,l,lt,g,at,nt,y,t,a,vt,i,fi,yt,pt,ei,wt=0,p,tt,it=null,bt="b_nrrwimg",rt="b_nrrwimgr",oi="b_nrrwimgb",ut="b_flyt",e="b_scactive",ft="b_scslbl",w="b_scdisp",et="target",ot="saved",v="scdactve",kt="errvsbl",dt="errinvsbl",gt="onVisualStateChanged",si="onCollectionsGotten",hi="onHostSavesControlClicked",ci="data-save-error-map",ni=5;n.UiErrorStates=["Ok","AddItem","RemoveItem","GetCollection","CreateCollection","Mismatch","Intermittent","BadItemData"];n.isCreateDialogShowing=!1;n.onSaveControlClicked=ir;n.toggleFlyout=nu;n.onSaveControlIcnClicked=tu;er()}(SvCtrlV2||(SvCtrlV2={})),function(n){function p(){c.scrollTop=0}function tt(t){var u=t.currentTarget,r=u.getAttribute(i),e=u.getAttribute(v),f=n.currentHoveredElement;if(r||e)sj_sp(t),sj_pd(t),t.stopImmediatePropagation();else return!0;if(n.logCollLstClick(n.currentHoveredElement,r),r==n.CustomCollDummyId){n.addToNewCollection(n.defOrCustCollName,n.currentHoveredElement,function(){d(n.CustomCollDummyId)});return}u.hasAttribute(o)?n.removeFromCollection(r,a,f):n.addToCollection(r,f,a)}function w(n){var t=n;if(/\/th(\/.*|)\?/i.test(n)){var i=n.split("?"),r=i[0],u=i[1];t=r+"?"+u.replace(/&?\b[whrc]=\d+/gi,"")+g}return t}function it(t){var f=t[1],u=t[2],r=_qs("["+i+'="'+f+'"] img',n.collectionList);r&&(u?r.src=w(u):r.removeAttribute("src"))}function u(t,i,r){r===void 0&&(r=!1);var u=r?function(n){t.insertBefore(n,t.firstChild)}:function(n){t.appendChild(n)};n.iterateThroughList(i,u)}function r(t,i){var r=function(n,i){i&&t.setAttribute(n,i)};n.iterateOverObject(i,r)}function f(n,t){return sj_ce(n,null,t)}function rt(t){var e,p=t[1],b=t[2],k=t[3],y=t[4],d=t[5],g=t[6],c,o,l,a,s;n.collectionList&&(c=f("div","b_svcimg"),o=sj_ce("img"),r(o,{role:"presentation"}),sj_be(o,"error",function(){o.removeAttribute("src")}),y&&(o.src=w(y)),u(c,[o]),l=f("div","b_svclnk"),a=f("p","b_ignbt"),a.textContent=k,u(l,[a]),s=f("li","b_svcitm"),r(s,(e={},e[i]=b||null,e[v]=d||null,e.tabindex="-1",e.role="option",e["aria-selected"]="false",e)),g&&h(s),u(s,[c,l]),u(n.collectionList,[s],p),n.addClickListener(s,tt,!0,!1))}function s(i){var u,f;p();u=!1;i===null||i===undefined?(f=e.getAttribute("aria-expanded"),f!=="false"||l||(n.logCollExpandClick(n.currentHoveredElement),l=!0),u=f==="true"?!1:!0):u=i;r(e,{"aria-expanded":u?"true":"false"});u?n.addElementClass(t,"xpnd"):n.removeElementClass(t,"xpnd");u&&sj_evt.fire(y);n.standalone&&sj_evt.fire(nt,u?4:3)}function b(t){return _qs("["+i+"='"+t+"']",n.collectionList)}function h(n){var t;r(n,(t={},t[o]="1",t["aria-selected"]="true",t))}function k(n){var t;n.removeAttribute(o);r(n,(t={},t["aria-selected"]="false",t))}function ut(n){var i=n[1],t=b(i);t&&h(t)}function ft(n){var i=n[1],t=b(i);t&&k(t)}function et(t){var r=t[1];n.iterateThroughList(Array.prototype.slice.call(n.collectionList.childNodes),function(n){r&&n.getAttribute(i)in r?h(n):k(n)})}function ot(t){var i;n.isCreateDialogShowing||(t.keyCode===38?(_d.activeElement.previousElementSibling&&_d.activeElement.previousElementSibling.focus(),sj_sp(t),sj_pd(t)):t.keyCode===40&&(_d.activeElement===n.collectionList?(i=_qs(".b_svcitm"))===null||i===void 0?void 0:i.focus():_d.activeElement.nextElementSibling&&_d.activeElement.nextElementSibling.focus(),sj_sp(t),sj_pd(t)))}function d(t){if(!t||!n.collectionList)return!1;var r=_qs("[".concat(i,'="').concat(t,'"]'),n.collectionList);return r?(n.collectionList.removeChild(r),!0):!1}function st(){n.collectionList=_ge("svctrllst");e=_ge("svctrlpckr");c=_ge("svctrllstw");t=_ge("svctrlhvrpnlbtn");t&&n.addClickListener(t,function(){return s()});sj_evt.bind("onCollRegister",rt,!0);sj_evt.bind("onCurrentCollIdSet",ut);sj_evt.bind("onCurrentCollIdUnset",ft);sj_evt.bind("onChangeCollThumbnail",it);sj_evt.bind("onResetScroll",p);sj_evt.bind("onHoverElementSet",et);sj_evt.bind("onBtnToggleCollList",function(){return s(!0)});sj_evt.bind("onControlAppended",function(){return s(!1)});sj_evt.bind("onSaveHover",function(){t||sj_evt.fire(y)});n.collectionList&&n.addListenerToElement(n.collectionList,"keydown",ot)}var e,c,t,l=!1,a="ColLst",i="data-svcid",v="data-svkct",o="data-svd",g="&w=40&h=40&c=7&r=0",y="onCollListExpand",nt="onVisualStateChanged";n.removeCollectionFromPicker=d;st()}(SvCtrlV2||(SvCtrlV2={})),function(n){function p(t,i){if(t&&i)return n.urlParamsTemplate.replace(/\{(\d)\}/g,w([t,i]))}function w(n,t){return t===void 0&&(t=!0),function(i,r){if(r){var u=n&&n[r]||"";return t&&u.length&&(u=encodeURIComponent(u)),u}return""}}function b(n){var i=n.ComponentId,e=n.PredefinedType.APIItemType,t=n.MetaLocInfo;if(t){var o=t.MetadataLocationId,s=t.MetadataLocationAttr,c=t.MetaLocCompName;r=o;u=s;f=c;h=p(e,f||i);g()}}function a(){var t=n.getMetadataId(n.metadataFromElement(n.metaLocElement));t&&n.localSavedItemsMap[t]?n.addElementClass(n.metaLocElement,l):n.removeElementClass(n.metaLocElement,l)}function k(){return n.metaLocElement}function i(n){sj_evt.fire("onPersButtonInteract",n.target,k(),u,h,f);sj_evt.fire("onBtnToggleCollList")}function o(t){if(t.type==="focusout"&&!n.shiftKeyDown){var i=t.relatedTarget;i&&(n.nextFocusable=i);n.ctrlBtn.focus();sj_evt.fire("onSaveButtonFocus");return}}function d(){t&&(r&&(n.metaLocElement=_ge(r)),n.addInListeners(t,i),n.addOutListeners(t,o),n.addClickListener(t,s,!0,!0),n.metaLocElement&&(a(),c=new MutationObserver(a),c.observe(n.metaLocElement,{attributes:!0,attributeFilter:[u]})))}function s(){n.onSaveControlClicked(n.currentElementMid,n.currentHoveredElement,!0)}function g(){if(n.persistentButtonClassName){y();var i=_qs("."+n.persistentButtonClassName,_d.body);i&&(t=i,d())}}function v(t){var r=t[0],i=t[2],u=t[4];u&&i===n.getMetadataId(n.metadataFromElement(n.metaLocElement))&&e&&(r==="onSaveAdd"&&n.localSavedItemsMap[i]||r==="onSaveDel"&&!n.localSavedItemsMap[i])&&e()}function y(){t&&(n.metaLocElement=null,t.removeEventListener("mouseenter",i),t.removeEventListener("focusin",i),t.removeEventListener("mouseleave",o),t.removeEventListener("focusout",o),t.removeEventListener("click",s),t.removeEventListener("keydown",s),t=null)}var r,u,f,h,e,t,c,l="saved";sj_evt.bind("onSaveRegButton",function(n){var t=n[1];e=t});sj_evt.bind("onPartnerRegister",function(n){var t=n[1];b(t)});sj_evt.bind("onDeregisterPersBtn",y);sj_evt.bind("ajax.unload",function(){t&&t.removeEventListener("mouseenter",i)});sj_evt.bind("onSaveDel",v);sj_evt.bind("onSaveAdd",v)}(SvCtrlV2||(SvCtrlV2={})),function(n){function t(t){n.fireOverlapping(t);sj_sp(t);n.onSaveControlClicked(n.currentElementMid,n.currentHoveredElement,!0)}function i(){n.ctrlBtn&&n.addClickListener(n.ctrlBtn,t,!0)}i()}(SvCtrlV2||(SvCtrlV2={}))